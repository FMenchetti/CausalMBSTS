% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/causal_mbsts.R
\name{causal.mbsts}
\alias{causal.mbsts}
\title{Causal effect estimation in a multivariate setting}
\usage{
causal.mbsts(
  Smodel,
  X,
  y,
  dates,
  int.date,
  horizon = NULL,
  H = NULL,
  nu0.k = NULL,
  s0.k,
  nu0.eps = NULL,
  s0.eps,
  niter,
  burn = NULL,
  ping = NULL
)
}
\arguments{
\item{Smodel}{A multivariate state space model of class 'SSModel'.}

\item{X}{T x N matrix of predictors.}

\item{y}{t x d matrix of observations.}

\item{dates}{a vector of dates.}

\item{int.date}{Date of the intervention.}

\item{horizon}{Optional, vector of dates. If provided, a causal effect is computed for any time horizon. It defaults to the date of the last observation.}

\item{H}{P x P variance-covariance matrix of the regression coefficients. Set by default to H = (X'X)^(-1).}

\item{nu0.k}{Degrees of freedom of the Inverse-Wishart prior for each Sigma_k. Set by default to n0.k = d + 2 where d is the number of time series in the multivariate model.}

\item{s0.k}{Scale matrix of the Inverse-Wishart prior for each Sigma_k.}

\item{nu0.eps}{Degrees of freedom of the Inverse-Wishart prior for Sigma_eps. Set by default to d + 2.}

\item{s0.eps}{Scale matrix of the Inverse-Wishart prior for Sigma.eps.}

\item{niter}{Number of MCMC iteration.}

\item{burn}{Desidered burn-in, set by default to 0.1 * niter.}

\item{ping}{A status message it's printed every 'ping' iteration, defaults to 0.1 * 'niter'.}
}
\value{

}
\description{
It estimates the general effect of an intervention in a multivariate time series
setting. It uses MCMC to sample from the joint posterior distribution of the parameters
of an MBSTS model before the intervention/treatment occurred. Then, it uses the
covariates post intervention to predict the counterfactual potential outcomes. 
The prediction is done by sampling from the posterior predictive 
distribution (ppd). Then the causal effect is computed by taking the difference between 
the observed outcome of each time series and the mean of the ppd (credible intervals are
computed accordingly).
}
\examples{
y <- cbind(rnorm(100), rnorm(100, 2, 3))
X <- cbind(rnorm(100, 0.5, 1) + 5, rnorm(100, 0.2, 2) - 2)
dates <- seq(as.Date('2020-01-10'),as.Date('2020-01-10')+99), 1)
int.date <- as.Date('2020-04-01')
y[dates >= int.date, ] <- y[dates >= int.date, ]+2
model <- SSModel(y ~ SSMtrend(degree = 1, Q = matrix(NA,2,2)) + SSMseasonal(period=4, Q = matrix(NA,2,2)))
causal <- causal.mbsts(model, X = X, y = y, dates = dates, int.date = int.date, s0.eps = diag(2), s0.k = diag(2), niter = 100, burn = 10)
}
